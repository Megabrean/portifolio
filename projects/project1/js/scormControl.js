let lmsPhases,trainingStatus,trainingComplete,suspendString,last_visited=null;function closeCourse(){window.onbeforeunload=null,window.onpagehide=null,window.onunload=null,unloadPage()}function writeLMSStatus(e){doLMSSetValue("cmi.core.lesson_location",e),doLMSCommit()}function writeLMSCompleteStatus(){doLMSSetValue("cmi.core.score.raw","100"),doLMSSetValue("cmi.core.lesson_status","completed"),doLMSCommit()}function writeLMSStatusIncomplete(){doLMSSetValue("cmi.core.lesson_status","incomplete"),doLMSCommit()}function endTraining(){trainingComplete=!0,validateScorm&&writeLMSCompleteStatus()}function updateSuspendDataLms(){if(validateScorm){let e=JSON.stringify(flow_obj);e=e.replace(/\"/g,"*"),doLMSSetValue("cmi.suspend_data",e),doLMSCommit()}}function updateSuspendObjPiv(){let e;lms_suspend_string=doLMSGetValue("cmi.suspend_data"),lms_suspend_string=lms_suspend_string.replace(/\*/g,'"'),e=JSON.parse(lms_suspend_string),flow_obj=e}function updateScreenOnScorm(e=!1){let t=currentScreen-1;e&&lmsPhases&&(lmsPhases=lmsPhases.substr(0,t)+"1"+lmsPhases.substr(t+1),currentScreen!==totalScreen||trainingComplete||endTraining());let s=t.toString()+";"+lmsPhases;validateScorm&&writeLMSStatus(s)}function beginTraining(){if(validateScorm&&(loadPage(),window.onbeforeunload=window.onpagehide=window.onunload=closeCourse,lmsPhases=doLMSGetValue("cmi.core.lesson_location"),""!=(suspendString=doLMSGetValue("cmi.suspend_data"))&&updateSuspendObjPiv(),trainingStatus=doLMSGetValue("cmi.core.lesson_status")),trainingComplete="completed"===trainingComplete,""!==lmsPhases&&void 0!==lmsPhases&&validateScorm){let e=parseInt(doLMSGetValue("cmi.core.lesson_location").split(";")[0])+1||1;last_visited=e,lmsPhases=e>9?lmsPhases.slice(3):lmsPhases.slice(2)}else lmsPhases="0".repeat(totalScreen);!trainingComplete&&validateScorm&&"incomplete"===trainingStatus&&writeLMSStatusIncomplete()}function controlScorm(){trainingComplete||updateScreenOnScorm(arguments[0])}